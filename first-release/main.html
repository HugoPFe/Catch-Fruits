<!DOCTYPE html>
	<html lang="pt-br">
	<head>

	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Game</title>

	<style>
	#screen {
	border: 10px solid #CCC;
	image-rendering: pixelated;
	image-rendering: crisp-edges;
	image-rendering: -moz-crisp-edges;
	width: 400px; 
	height: 400px;
	}

	</style>

	</head>

	<body>
		<canvas id="screen" width="10" height="10"></canvas>

			<script type="module">
				import createKeyboardListener from './keyboard-listener.js'
				import createGame from './game.js'
				const screen = window.document.getElementById("screen")
				const context = screen.getContext('2d')
				const currentPlayerId = 'player1'

				const game = createGame()
				const keyBoardListener = createKeyboardListener()
				keyBoardListener.subscribe(game.movePlayer)

				game.addPlayer({playerId: 'player1', x: 0, y: 0})
				game.addPlayer({playerId: 'player2', x: 0, y: 7})
				game.addPlayer({playerId: 'player3', x: 8, y: 0})

				game.addFruit({fruitId: 'fruit1', x: 9, y: 9}) 
				game.addFruit({fruitId: 'fruit2', x: 2, y: 5}) 

				renderScreen()

				function renderScreen() {
					context.fillStyle = 'white'
					context.clearRect(0, 0, 10, 10)

					const state = game.state
					
					for (const playerId in state.players) {
						const player = state.players[playerId]
						context.fillStyle = 'black'
						context.fillRect(player.x, player.y, 1, 1)
					}
					
					for (const fruitId in state.fruits) {
						const fruit = state.fruits[fruitId]
						context.fillStyle = 'green'
						context.fillRect(fruit.x, fruit.y, 1, 1)
					}
					
					requestAnimationFrame(renderScreen)
				}

			</script>
	</body>
</html>